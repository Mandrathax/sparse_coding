\documentclass[a4paper, titlepage]{article}
\usepackage[sectionmark,fancysections]{polytechnique}
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[]{algorithm2e}

\renewcommand{\vec}[1]{\mathbf{#1}}
\renewcommand{\contentsname}{Sommaire}



\title{INF 552\\Image et vision par ordinateur}
\subtitle{Projet : Reconstruction d'images par apprentissage}
\date{17 Janvier 2016}
\author{Paul Michel\\Antoine Prouvost\\Élèves en troisième année}

\begin{document}
\maketitle

\tableofcontents

\cleardoublepage
\section*{Introduction}
\addcontentsline{toc}{section}{Introduction}

Nos motivations pour ce projet étaient de pouvoir implementer un algorithme d'apprentissage avec une vraie application au traitement des images.

Nous avons rapidement trouvé des travaux de recherche de l'Inria ainsi qu'un cours qui s'intéressaient à ce sujet \cite{ref1}. L'idée qui nus a tout de suite plut était de pouvoir reconstruire des images bruitées, partiellement détruites ou marquées.

Le fonctionnement de l'algorithme consiste à apprendre un dictionnaire de sous images, appelés "patches", de l'image initiale ;  puis, d'utiliser celui-ci pour reconstruire chaque patche.

\cleardoublepage
\section{Algorithme et références}
	\subsection{Dictionary Learning}
	Pour apprendre le dictionnaire, nous avons suivi les travaux de l'article \cite{ref3}. 
	
	Nous commençons par extraire l'ensemble des patches de l'image. Un patch est représenté ici comme un vecteur $\vec{x} \in \mathbb{R}^{m}$ où $m \in \mathbb{N}^{*}$ est la taille constante des patches (son nombre de pixels). Le dictionnaire, dont nous fixons la taille  $k \in \mathbb{N}^{*}$ est quant à lui représenté par une matrice $\vec{D} \in \mathbb{R}^{m*k}$. Les éléments du dictionnaire sont stockés en colones.\\
	
	\begin{algorithm}[H]
 		\KwData{$\lambda \in \mathbb{R}$, facteur de régularisation\\
		$T \in \mathbb{N}$, nombre d'itération de l'algorithme}
 		\KwResult{Un dictionnaire $\vec{D} \in \mathbb{R}^{m*k}$}
 		Remplir le dictionnaire initial $\vec{D}$ en choisissant aléatoirement des patches de l'image\;
		Initialiser deux matrices $\vec{A} \in \mathbb{R}^{m*m}$ et $\vec{B} \in \mathbb{R}^{m*k}$ à $0$\;
 		\For{$t=1$ to $T$}{
 		 	Tirer aléatoirement un patche $\vec{x} \in \mathbb{R}^{m}$ dans le dictionnaire (OU DANS LES PATCHS ?)\;
			Calculer :$$\alpha = \arg \min_{\alpha \in  \mathbb{R}^{m}} \frac{1}{2}\parallel \vec{x} - \vec{D}*\vec{\alpha}\parallel_{2}^{2} + \lambda\parallel \vec{\alpha} \parallel_{1} $$à l'aide de LARS\;
			$A = A + \alpha\alpha^{T}$\;
			$B = B + \vec{x}\alpha^{T}$\;
			\For{$j=1$ to $k$}{
				$\vec{u} = \frac{1}{\vec{A}_{j,j}}(\vec{b}_{j} - \vec{D}\vec{a}_{j})$\;
				$\vec{d}_{j} = \frac{1}{\max (\parallel\vec{u}\parallel_{2},1)}$\;
			}
 			 
	 	}
		 \Return D\;
 \caption{Online dictionary learning}
\end{algorithm}
	\subsection{Reconstruction d'image}

\cleardoublepage
\section{Implementation, résultats et interprétation}

\cleardoublepage
\bibliographystyle{plain}
\addcontentsline{toc}{section}{References}
\bibliography{biblio}
\end{document}
